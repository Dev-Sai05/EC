IDENTIFICATION DIVISION.
       PROGRAM-ID. ReadEnvPropsSimple.

       DATA DIVISION.
       WORKING-STORAGE SECTION.

       01  IN-FILE              PIC X(256) VALUE "C:\Users\V1010513\Documents\Configs\application.properties".
       01  FILE-IN              FILE STATUS IS WS-STATUS.

       01  WS-STATUS            PIC XX.
       01  LINE                PIC X(300).
       01  PROPERTY-NAME       PIC X(100).
       01  PROPERTY-VALUE      PIC X(200).

       01  ENV-NAME            PIC X(100).
       01  ENV-VALUE           PIC X(200).
       01  ENV-VALUE-LEN       PIC S9(4) COMP-5 VALUE 200.
       01  ENV-STATUS          PIC S9(4) COMP-5.

       01  DB-URL              PIC X(200).
       01  DB-USER             PIC X(100).
       01  DB-PASS             PIC X(100).

       FILE-CONTROL.
           SELECT FILE-IN ASSIGN TO IN-FILE
               ORGANIZATION IS LINE SEQUENTIAL.

       FILE SECTION.
       FD  FILE-IN.
       01  FILE-LINE           PIC X(300).

       PROCEDURE DIVISION.

       MAIN-LOGIC.
           OPEN INPUT FILE-IN

           PERFORM UNTIL WS-STATUS NOT = "00"
               READ FILE-IN INTO LINE
                   AT END
                       MOVE "99" TO WS-STATUS
               NOT AT END
                   MOVE "00" TO WS-STATUS
                   PERFORM PARSE-AND-RESOLVE
               END-READ
           END-PERFORM

           CLOSE FILE-IN

           DISPLAY "========================="
           DISPLAY "DB URL  : " DB-URL
           DISPLAY "DB USER : " DB-USER
           DISPLAY "DB PASS : " DB-PASS
           DISPLAY "========================="

           STOP RUN.

       PARSE-AND-RESOLVE.
           UNSTRING LINE DELIMITED BY "="
               INTO PROPERTY-NAME PROPERTY-VALUE
           END-UNSTRING

           *> Remove spaces and trim
           INSPECT PROPERTY-NAME REPLACING LEADING SPACES BY ""
           INSPECT PROPERTY-VALUE REPLACING LEADING SPACES BY ""

           *> Check if value starts with ${
           IF PROPERTY-VALUE(1:2) = "${"
               MOVE SPACES TO ENV-NAME
               UNSTRING PROPERTY-VALUE DELIMITED BY "}" INTO ENV-NAME
               INSPECT ENV-NAME REPLACING LEADING "${" BY ""

               CALL "CBL_GETENV"
                   USING ENV-NAME
                         ENV-VALUE
                         ENV-VALUE-LEN
                   GIVING ENV-STATUS

               IF PROPERTY-NAME = "db.url"
                   MOVE ENV-VALUE TO DB-URL
               ELSE IF PROPERTY-NAME = "db.user"
                   MOVE ENV-VALUE TO DB-USER
               ELSE IF PROPERTY-NAME = "db.pass"
                   MOVE ENV-VALUE TO DB-PASS
               END-IF
           ELSE
               IF PROPERTY-NAME = "db.url"
                   MOVE PROPERTY-VALUE TO DB-URL
               ELSE IF PROPERTY-NAME = "db.user"
                   MOVE PROPERTY-VALUE TO DB-USER
               ELSE IF PROPERTY-NAME = "db.pass"
                   MOVE PROPERTY-VALUE TO DB-PASS
               END-IF
           END-IF.